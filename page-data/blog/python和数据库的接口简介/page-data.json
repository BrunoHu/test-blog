{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/python和数据库的接口简介/","result":{"data":{"site":{"id":"Site","siteMetadata":{"title":"Bates Hu"}},"markdownRemark":{"id":"f66a59db-ab77-588b-abca-4270596c06f2","excerpt":"刚好最近在自学数据库，就特地写出来数据库和python连接的接口出来权当复习。现在比较流行的数据库一个是关系型数据库MySQL以及非关系型数据库，另外一个就是所谓的noSQL类型的文档数据库Mongodb。这两个都是这两方面开源软件的佼佼者，社区丰富资源多。我是不会告诉你们我只看了这俩的。 python-MySQL…","html":"<p>刚好最近在自学数据库，就特地写出来数据库和python连接的接口出来权当复习。现在比较流行的数据库一个是关系型数据库<strong>MySQL</strong>以及非关系型数据库，另外一个就是所谓的noSQL类型的文档数据库<strong>Mongodb</strong>。这两个都是这两方面开源软件的佼佼者，社区丰富资源多。我是不会告诉你们我只看了这俩的。</p>\n<h3>python-MySQL接口</h3>\n<p>首先，要安装这个接口。</p>\n<blockquote>\n<p><code class=\"language-text\">$sudo pip install python-mysql</code></p>\n</blockquote>\n<p>然后，介绍一个典型的接口实现。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">import MySQLdb\nconn = MySQLdb.connect(\n            db = &#39;dbname&#39;,\n            user = &#39;root&#39;,\n            passwd = &#39;your-password&#39;,\n            host = &#39;localhost&#39;,\n            charset = &#39;utf8&#39;,\n            use_unicode = True)\ncursor = conn.cursor()\ncursor.execute(&quot;truncate table xiaomihr;&quot;)\nconn.commit()\ncursor.execute(&quot;&quot;&quot;INSERT INTO xiaomihr(item_id, work, worktype, location, hr_way)\n                        VALUES (%s, %s, %s, %s, %s)&quot;&quot;&quot;,\n                        (\n                            item[&#39;item_id&#39;],\n                            item[&#39;work&#39;][0],\n                            item[&#39;worktype&#39;][0],\n                            item[&#39;location&#39;][0],\n                            item[&#39;hr_way&#39;][0]\n                        )\n        )\nconn.commit()</code></pre></div>\n<p>这个程序是摘取自一个爬虫程序最后吧数据存入数据库的阶段。总的来说，这个接口就是这么几个东西：</p>\n<ol>\n<li>建立到数据库的连接。<code class=\"language-text\">conn = MySQLdb.connect(...)</code></li>\n<li>获取数据库的游标。 <code class=\"language-text\">cursor = conn.cursor()</code></li>\n<li>给出指令。 <code class=\"language-text\">cursor.exxcute(&quot;truncate table xiaomihr;&quot;)</code>,双引号括住的是要执行的SQL语句，这个SQL语句就属于另外一个方面了，这个语句的意思是把<code class=\"language-text\">xiaomihr</code>这个表清空。另外一个语句则是典型的插入数据到数据库的语句<code class=\"language-text\">cursor.execute(&quot;&quot;&quot;INSERT INTO xiaomihr(...))</code>,把相应的值插入对应的字段中。</li>\n<li>提交到数据库。 <code class=\"language-text\">conn.commit()</code>,我觉得接触过ORM的人应该了解这个，就是把指令提交，通过连接传输到数据库执行，所有的操作后面一定要加这个，不然不会执行。</li>\n</ol>\n<p>这就是一个python-MySQL接口的典型实现。</p>\n<h3>python-Mongodb接口</h3>\n<p>同样，第一步安装pymongo</p>\n<blockquote>\n<p><code class=\"language-text\">$sudo pip install pymongo</code></p>\n</blockquote>\n<p>第二步也是介绍一个典型实现。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">from pymongo import MongoClient\n\nclient = MongoClient(&#39;localhost&#39;,27017)\ndb = client[&#39;xiaomihr&#39;]\ncollection = db[&#39;hr_imfomation&#39;]\ncollection.remove()\n\ndata = {\n&#39;item_id&#39; : item[&#39;item_id&#39;],\n&#39;work&#39; : item[&#39;work&#39;][0],\n&#39;worktype&#39; : item[&#39;worktype&#39;][0],\n&#39;location&#39; : item[&#39;location&#39;][0],\n&#39;hr_way&#39; : item[&#39;hr_way&#39;][0]}\ncollection.insert(data)</code></pre></div>\n<p>这个是同样上面那个程序在Mongodb接口下是实现。</p>\n<ol>\n<li>建立连接 <code class=\"language-text\">client = MongoClient()</code></li>\n<li>选取数据库 <code class=\"language-text\">db = cliet[&#39;xiaomihr&#39;]</code>,xiaomihr是数据库的名字。</li>\n<li>选取集合 <code class=\"language-text\">collection = db[&#39;hr_imfomation&#39;]</code>,hr_imformation是集合的名字（类似于MySQL里的表）。</li>\n<li>然后就几乎和mongodb本身的操作一样，不需要和MySQL接口一样把指令包装成字符串再处理，pymongo直接就和在mongodb里操作一样，清空数据库就是<code class=\"language-text\">collection.remove()</code>，典型的插入数据就是<code class=\"language-text\">collection.insert(data)</code>。</li>\n</ol>\n<blockquote>\n<p>值得注意的是，在pymongo的早期版本中和现在网上的教程中，有很多给出的实现是这样的</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">connection = pymongo.Connection(&#39;localhost&#39;,27017)\ndb = connection.test_database\ncollection = db.test_collection</code></pre></div>\n<blockquote>\n<p>这个在最新的版本中已经用不了了，官方给出的最佳实现是上面那个。</p>\n</blockquote>","frontmatter":{"title":"python和数据库的接口简介","date":"January 30, 2016","description":null,"tags":["python","数据库","code"]}}},"pageContext":{"slug":"/python和数据库的接口简介/","previous":{"fields":{"slug":"/暴力解决三门问题/"},"frontmatter":{"title":"暴力解决三门问题"}},"next":{"fields":{"slug":"/数独的高效深度搜索解法/"},"frontmatter":{"title":"数独的高效深度搜索解法"}}}}}